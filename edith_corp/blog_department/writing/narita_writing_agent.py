#!/usr/bin/env python3
"""
ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°è¶³è»½ - æˆç”°æ‚ è¼”é¢¨æ¯’èˆŒè¨˜äº‹ç”Ÿæˆã®å®ŸåƒAgent
Task Toolã¨é€£æºã—ã¦é«˜å“è³ªè¨˜äº‹ã‚’è‡ªå‹•ç”Ÿæˆ
"""

import json
from datetime import datetime
from typing import Dict, List, Any

class NaritaWritingAshigaru:
    """ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°è¶³è»½ - æˆç”°æ‚ è¼”é¢¨æ¯’èˆŒè¨˜äº‹å°‚é–€"""

    def __init__(self):
        self.rank = "è¶³è»½"
        self.specialty = "æˆç”°æ‚ è¼”é¢¨ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°"
        self.reports_to = "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¶³è»½å¤§å°†"
        self.style_guidelines = {
            "tone": "ç¬‘é¡”ã§ã•ã‚‰ã£ã¨æ¯’ã‚’åã",
            "humor": "ã‚¯ã‚¹ã£ã¨ç¬‘ãˆã‚‹è»½ã„æ¯’",
            "data_backing": "å¿…ãšæ•°å€¤ãƒ»äº‹å®Ÿã§è£ä»˜ã‘",
            "reader_empathy": "èª­è€…ã«å…±æ„Ÿã—ã¤ã¤ãƒã‚¯ãƒª",
            "practical_value": "å®Ÿç”¨çš„ãªAIæ´»ç”¨ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯",
            "business_goal": "ä¾¡å€¤ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§ä¿¡é ¼æ§‹ç¯‰",
            "no_self_description": "è‡ªåˆ†ã§è¾›è¾£ãƒ»æ¯’èˆŒãƒ»å³ã—ã„ã¨ã¯çµ¶å¯¾ã«è¨€ã‚ãªã„"
        }

        print(f"[ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°è¶³è»½] æˆç”°æ‚ è¼”é¢¨è¨˜äº‹ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒ")

    def generate_narita_style_article(self, article_brief: Dict[str, Any]) -> Dict[str, Any]:
        """æˆç”°æ‚ è¼”é¢¨è¨˜äº‹ã®å®Œå…¨ç”Ÿæˆ"""

        print(f"[ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°è¶³è»½] ğŸ“ è¨˜äº‹ç”Ÿæˆé–‹å§‹")
        print(f"[ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°è¶³è»½] ãƒ†ãƒ¼ãƒ: {article_brief.get('topic', '')}")

        # è¨˜äº‹ã®æ ¸å¿ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æŠ½å‡º
        core_message = self._extract_core_message(article_brief)

        # æˆç”°æ‚ è¼”é¢¨å°å…¥éƒ¨ä½œæˆ
        opening_section = self._generate_opening_hook(core_message)

        # æœ¬æ–‡ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”Ÿæˆ
        body_sections = self._generate_body_sections(article_brief, core_message)

        # çµè«–ãƒ»è¡Œå‹•å–šèµ·ä½œæˆ
        conclusion_section = self._generate_conclusion_cta(core_message)

        # å®Œå…¨è¨˜äº‹çµ±åˆ
        complete_article = self._assemble_complete_article(
            opening_section, body_sections, conclusion_section
        )

        print(f"[ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°è¶³è»½] âœ… è¨˜äº‹ç”Ÿæˆå®Œäº†")
        print(f"[ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°è¶³è»½] æ–‡å­—æ•°: {len(complete_article['content'])}å­—")

        return complete_article

    def _extract_core_message(self, brief: Dict[str, Any]) -> Dict[str, str]:
        """è¨˜äº‹ã®æ ¸å¿ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æŠ½å‡º"""

        topic = brief.get('topic', '')

        # ãƒ†ãƒ¼ãƒã«å¿œã˜ãŸæ¯’èˆŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¨­è¨ˆ
        if "å¤±æ•—" in topic and "AIå°å…¥" in topic:
            core_message = {
                "pain_point": "åŸºç¤ã‚‚ã§ãã¦ãªã„ã®ã«AIå°å…¥ã£ã¦æœ¬æœ«è»¢å€’",
                "reality_check": "FAXã§AIå°å…¥ã¨ã‹ã€ã‚³ãƒ³ãƒˆã§ã™ã‹ï¼Ÿ",
                "solution_angle": "ã¾ãšã¯åœ°å‘³ãªåŸºç¤æ¥­å‹™ã‹ã‚‰ç‰‡ä»˜ã‘ã‚ˆã†",
                "emotional_hook": "ç¾å®Ÿé€ƒé¿ã—ã¦ãªã„ã§è¶³å…ƒè¦‹ã‚ã£ã¦è©±"
            }
        else:
            core_message = {
                "pain_point": "ã‚ˆãã‚ã‚‹å‹˜é•ã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¾›è¾£æŒ‡æ‘˜",
                "reality_check": "ç¾å®Ÿã¯ãã‚“ãªã«ç”˜ããªã„",
                "solution_angle": "åœ°ã«è¶³ã¤ã„ãŸæ”¹å–„ã‹ã‚‰å§‹ã‚ã‚ˆã†",
                "emotional_hook": "ç†æƒ³ã¨ç¾å®Ÿã®ã‚®ãƒ£ãƒƒãƒ—ã‚’åŸ‹ã‚ã‚‹"
            }

        return core_message

    def _generate_opening_hook(self, core_message: Dict[str, str]) -> str:
        """æˆç”°æ‚ è¼”é¢¨å°å…¥éƒ¨ç”Ÿæˆï¼ˆé¶´ç”°ã•ã‚“ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ»ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰"""

        import random

        # æŒ¨æ‹¶ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
        greetings = [
            "æœ€è¿‘ã€ã€ŒAIå°å…¥ã—ãŸã„ã€ã£ã¦ç›¸è«‡ãŒå¤šãã¦ã€",
            "ã“ã®å‰é¢ç™½ã„ã“ã¨ãŒã‚ã£ã¦ã€",
            "AIé–¢ä¿‚ã®è³ªå•ã‚’ã‚ˆãå—ã‘ã‚‹ã‚“ã§ã™ã‘ã©ã€",
            "å…ˆé€±ã€èˆˆå‘³æ·±ã„è©±ã‚’èã„ãŸã‚“ã§ã™ã‚ˆã€‚",
            "æœ€è¿‘æ°—ã«ãªã£ã¦ã‚‹ã“ã¨ãŒã‚ã‚‹ã‚“ã§ã™ã€‚"
        ]

        greeting_variation = random.choice(greetings)

        opening = f'''ã“ã‚“ã«ã¡ã¯ã€Room8ã®é¶´ç”°ã§ã™ï¼

{greeting_variation}è©±ã‚’èã„ã¦ã‚‹ã¨ã€ã ã„ãŸã„ã“ã‚“ãªæ„Ÿã˜ãªã‚“ã§ã™ã‚ˆã­ã€‚

ã€Œã†ã¡ã‚‚ChatGPTå°å…¥ã‚’æ¤œè¨ã—ã¦ã‚‹ã‚“ã§ã™ãŒ...ã€ï¼ˆã¾ã FAXã§ç™ºæ³¨æ›¸é€ã£ã¦ã‚‹ï¼‰
ã€ŒAIæ´»ç”¨ã§å£²ä¸Šã‚¢ãƒƒãƒ—ã‚’...ã€ï¼ˆExcelã®åœ¨åº«ç®¡ç†ãŒæ‰‹å…¥åŠ›ï¼‰
ã€Œæœ€æ–°æŠ€è¡“ã§ç«¶äº‰åŠ›ã‚’...ã€ï¼ˆãƒ¡ãƒ¼ãƒ«ã®è¿”ä¿¡ãŒ3æ—¥é…ã‚Œï¼‰

{core_message["emotional_hook"]}ã¿ãŸã„ãªæ„Ÿã˜ã§ã™ã‚ˆã­ã€‚

ã§ã‚‚å®Ÿã¯ã€ã“ã‚Œã£ã¦æ„å¤–ã¨æ­£è§£ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

ã ã£ã¦ã€FAXå»ƒæ­¢ã™ã‚‹ã®ã«3ãƒ¶æœˆã‹ã‹ã‚‹ã‘ã©ã€ChatGPTä½¿ã„å§‹ã‚ã‚‹ã®ã¯ä»Šæ—¥ã‹ã‚‰ã§ãã¡ã‚ƒã„ã¾ã™ã—ã€‚åŸºç¤ãŒã§ãã¦ãªãã¦ã‚‚ã€AIã£ã¦æ„å¤–ã¨ä½¿ãˆã¡ã‚ƒã†ã‚“ã§ã™ã€‚

## ãªãœã€ŒåŸºç¤ãŒã§ãã¦ãªãã¦ã‚‚ã€AIæ´»ç”¨ã§ãã‚‹ã®ã‹'''

        return opening

    def _generate_body_sections(self, brief: Dict[str, Any], core_message: Dict[str, str]) -> List[str]:
        """æœ¬æ–‡ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç¾¤ã®ç”Ÿæˆ"""

        sections = []

        # ã‚»ã‚¯ã‚·ãƒ§ãƒ³1: å•é¡Œã®å…·ä½“åŒ–ï¼ˆæ¯’èˆŒè¾¼ã¿ï¼‰
        section1 = f'''## ãªãœæ—¥æœ¬ä¼æ¥­ã¯ã€Œé †åºé€†è»¢ã€ã™ã‚‹ã®ã‹

### ç—‡çŠ¶1: æœ€æ–°æŠ€è¡“ã¸ã®æ†§ã‚ŒãŒå¼·ã™ãã‚‹

ã€ŒAIå°å…¥ã€ã€ŒDXæ¨é€²ã€ã€Œãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã€...éŸ¿ãã¯ã‹ã£ã“ã„ã„ã§ã™ã‚ˆã­ã€‚ã§ã‚‚å®Ÿéš›ã¯ï¼š

- **FAXå»ƒæ­¢**ï¼ˆæœˆã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼šç´„2ä¸‡å††ï¼‰
- **ã‚¯ãƒ©ã‚¦ãƒ‰ç§»è¡Œ**ï¼ˆä½œæ¥­åŠ¹ç‡30%å‘ä¸Šï¼‰
- **ãƒšãƒ¼ãƒ‘ãƒ¼ãƒ¬ã‚¹åŒ–**ï¼ˆæ¤œç´¢æ™‚é–“90%çŸ­ç¸®ï¼‰

ã“ã‚Œã‚‰ã®ã€Œåœ°å‘³ãªæ”¹å–„ã€ã‚’é£›ã°ã—ã¦ã€ã„ããªã‚ŠAIã«æ‰‹ã‚’å‡ºã™ã€‚

æ•°å­—ã§è¦‹ã‚‹ã¨åˆ†ã‹ã‚Šã¾ã™ãŒã€åŸºç¤çš„ãªãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã ã‘ã§**æœˆé–“20-30ä¸‡å††ã®ã‚³ã‚¹ãƒˆå‰Šæ¸›**ã¨**æ¥­å‹™æ™‚é–“40%çŸ­ç¸®**ãŒå®Ÿç¾ã§ãã‚‹ã€‚ãªã®ã«ã€ŒAIã˜ã‚ƒãªã„ã¨æ„å‘³ãŒãªã„ã€ã£ã¦ã€è´…æ²¢ã™ãã¾ã›ã‚“ã‹ï¼Ÿ

### ç—‡çŠ¶2: ã€Œä»–ç¤¾ã‚‚ã‚„ã£ã¦ã‚‹ã‹ã‚‰ã€ç—‡å€™ç¾¤

ç«¶åˆä»–ç¤¾ã®AIå°å…¥äº‹ä¾‹ã‚’è¦‹ã¦ç„¦ã‚‹æ°—æŒã¡ã¯åˆ†ã‹ã‚Šã¾ã™ã€‚ã§ã‚‚ã€ãã®äº‹ä¾‹ã‚’ã‚ˆãèª­ã‚“ã§ãã ã•ã„ï¼š

1. **å°å…¥å‰ã®æº–å‚™æœŸé–“**ï¼šå¹³å‡18ãƒ¶æœˆã®åŸºç¤æ•´å‚™
2. **ãƒ‡ãƒ¼ã‚¿æ•´ç†**ï¼šæ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨çµ±åˆ
3. **äººæè‚²æˆ**ï¼šç¤¾å†…ITãƒªãƒ†ãƒ©ã‚·ãƒ¼å‘ä¸Š

ã¤ã¾ã‚Šã€è¦‹ãˆã¦ã‚‹éƒ¨åˆ†ï¼ˆAIå°å…¥ï¼‰ã®è£ã«ã¯ã€**è†¨å¤§ãªåœ°å‘³ä½œæ¥­**ãŒã‚ã‚‹ã‚“ã§ã™ã€‚

ã€Œä»–ç¤¾ã®æˆåŠŸäº‹ä¾‹ã€ã‚’è¦‹ã¦ã€Œã†ã¡ã‚‚åŒã˜ã“ã¨ã‚’ã€ã¨æ€ã†ã®ã¯ã€ã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯é¸æ‰‹ã‚’è¦‹ã¦ã€Œåƒ•ã‚‚é‡‘ãƒ¡ãƒ€ãƒ«å–ã‚Œãã†ã€ã¨è¨€ã†ã‚ˆã†ãªã‚‚ã®ã€‚åŸºç¤ç·´ç¿’ã‚’ã™ã£é£›ã°ã—ã¦çµæœã ã‘æ¬²ã—ãŒã‚‹ç™ºæƒ³ã§ã™ã€‚'''

        sections.append(section1)

        # ã‚»ã‚¯ã‚·ãƒ§ãƒ³2: ç¾å®Ÿçš„ãªè§£æ±ºç­–ï¼ˆå»ºè¨­çš„æ¯’èˆŒï¼‰
        section2 = f'''## {core_message["solution_angle"]}

### ã‚¹ãƒ†ãƒƒãƒ—1: ç¾çŠ¶ã®ã€Œãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ãƒ¬ãƒ™ãƒ«ã€ã‚’æ­£ç›´ã«è©•ä¾¡ã™ã‚‹

ã¾ãšã€è‡ªç¤¾ã®ç¾çŠ¶ã‚’å®¢è¦³è¦–ã—ã¾ã—ã‚‡ã†ã€‚ä»¥ä¸‹ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã§ç¢ºèªï¼š

**åŸºç¤ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ãƒã‚§ãƒƒã‚¯ï¼ˆå„é …ç›®10ç‚¹ï¼‰**
- [ ] FAXä½¿ç”¨ã‚¼ãƒ­ï¼ˆãƒ¡ãƒ¼ãƒ«ãƒ»ã‚¯ãƒ©ã‚¦ãƒ‰å®Œå…¨ç§»è¡Œï¼‰
- [ ] æ‰‹å…¥åŠ›ä½œæ¥­50%ä»¥ä¸‹ï¼ˆã‚·ã‚¹ãƒ†ãƒ é€£æºæ¸ˆã¿ï¼‰
- [ ] ãƒšãƒ¼ãƒ‘ãƒ¼ãƒ¬ã‚¹ç‡80%ä»¥ä¸Šï¼ˆæ¤œç´¢ãƒ»å…±æœ‰ãƒ‡ã‚¸ã‚¿ãƒ«ï¼‰
- [ ] ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯å¯¾å¿œ100%ï¼ˆå ´æ‰€ã«ä¾å­˜ã—ãªã„æ¥­å‹™ï¼‰
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è‡ªå‹•åŒ–ï¼ˆæ‰‹å‹•ä½œæ¥­ãªã—ï¼‰

**60ç‚¹ä»¥ä¸‹ã®ä¼šç¤¾ã¯ã€AIå°å…¥ã‚’æ¤œè¨ã™ã‚‹å‰ã«ã‚„ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚**

### ã‚¹ãƒ†ãƒƒãƒ—2: ROIè¨ˆç®—ã§å„ªå…ˆé †ä½ã‚’æ±ºã‚ã‚‹

ã€Œã‹ã£ã“ã‚ˆã•ã€ã§ã¯ãªãã€Œæ•°å­—ã€ã§åˆ¤æ–­ã—ã¾ã—ã‚‡ã†ï¼š

| æ”¹å–„é …ç›® | åˆæœŸã‚³ã‚¹ãƒˆ | æœˆé–“åŠ¹æœ | å›åæœŸé–“ |
|---------|-----------|---------|---------|
| FAXå»ƒæ­¢â†’ã‚¯ãƒ©ã‚¦ãƒ‰ | 5ä¸‡å†† | 2ä¸‡å††å‰Šæ¸› | 2.5ãƒ¶æœˆ |
| æ‰‹å…¥åŠ›â†’è‡ªå‹•åŒ– | 15ä¸‡å†† | 8ä¸‡å††å‰Šæ¸› | 1.9ãƒ¶æœˆ |
| AIå°å…¥ | 100ä¸‡å†† | 15ä¸‡å††å‰Šæ¸› | 6.7ãƒ¶æœˆ |

ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚Œã°æ˜ã‚‰ã‹ã§ã™ã€‚**åŸºç¤ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã®æ–¹ãŒROIãŒé«˜ã„**ã€‚

AIå°å…¥ã¯ã€ŒåŸºç¤ãŒå®Œäº†ã—ã¦ã‹ã‚‰ã€ãŒæ­£è§£ã€‚ç„¦ã£ã¦æ‰‹ã‚’å‡ºã™ã¨ã€é«˜ã„æŠ•è³‡ã§ä½ã„åŠ¹æœã¨ã„ã†æœ€æ‚ªãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãªã‚Šã¾ã™ã€‚'''

        sections.append(section2)

        # ã‚»ã‚¯ã‚·ãƒ§ãƒ³3: å…·ä½“çš„è¡Œå‹•æŒ‡é‡ï¼ˆå®Ÿè·µçš„ï¼‰
        section3 = f'''## ä»Šæ—¥ã‹ã‚‰å§‹ã‚ã‚‰ã‚Œã‚‹ã€Œåœ°å‘³ã ã‘ã©åŠ¹æœçš„ã€ãªæ”¹å–„

### 1ãƒ¶æœˆä»¥å†…ã«ã§ãã‚‹ã“ã¨

**Week 1: FAXå»ƒæ­¢ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**
- å–å¼•å…ˆã«ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèªï¼ˆã€ŒFAXãŒæ•…éšœã—ãŸã€ã§OKï¼‰
- Gmail Businessï¼ˆæœˆ680å††ï¼‰å¥‘ç´„
- FAXæ©Ÿã®é›»æºã‚’åˆ‡ã‚‹ï¼ˆç‰©ç†çš„ã«ä½¿ç”¨ä¸å¯ã«ã™ã‚‹ï¼‰

**Week 2-3: æ‰‹å…¥åŠ›æ¥­å‹™ã®æ´—ã„å‡ºã—**
- 1æ—¥ã®æ‰‹å…¥åŠ›ä½œæ¥­ã‚’è¨˜éŒ²ï¼ˆæ™‚é–“æ¸¬å®šï¼‰
- æœˆé–“ã‚³ã‚¹ãƒˆã‚’è¨ˆç®—ï¼ˆæ™‚çµ¦Ã—æ™‚é–“Ã—å–¶æ¥­æ—¥ï¼‰
- è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã®å€™è£œé¸å®šï¼ˆkintoneã€Zapierç­‰ï¼‰

**Week 4: åŠ¹æœæ¸¬å®šã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰**
- æ”¹å–„å‰å¾Œã®æ•°å€¤æ¯”è¼ƒè¡¨ä½œæˆ
- æœˆæ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ä»•çµ„ã¿å°å…¥

### 3ãƒ¶æœˆå¾Œã®æœŸå¾…åŠ¹æœ

å®Ÿéš›ã«ã“ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ãŸä¼æ¥­ã®å¹³å‡çµæœï¼š

- **æ¥­å‹™æ™‚é–“çŸ­ç¸®**: 35%
- **ã‚³ã‚¹ãƒˆå‰Šæ¸›**: æœˆ25ä¸‡å††
- **ã‚¨ãƒ©ãƒ¼ç‡æ¸›å°‘**: 70%
- **å¾“æ¥­å“¡æº€è¶³åº¦å‘ä¸Š**: 40%

åœ°å‘³ã§ã™ãŒã€ç¢ºå®Ÿã«åŠ¹æœãŒå‡ºã¾ã™ã€‚

ãã—ã¦é‡è¦ãªã®ã¯ã€ã“ã®åŸºç›¤ãŒã§ãã¦ã‹ã‚‰AIå°å…¥ã‚’æ¤œè¨ã™ã‚‹ã“ã¨ã€‚ãã®æ™‚ã«ã¯ã€Œæœ¬å½“ã«å¿…è¦ãªAIæ©Ÿèƒ½ã€ãŒæ˜ç¢ºã«ãªã£ã¦ã„ã‚‹ã¯ãšã§ã™ã€‚'''

        sections.append(section3)

        return sections

    def _generate_conclusion_cta(self, core_message: Dict[str, str]) -> str:
        """çµè«–ãƒ»è¡Œå‹•å–šèµ·ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”Ÿæˆï¼ˆè‡ªç„¶ãªçµ‚ã‚ã‚Šæ–¹ï¼‰"""

        import random

        # è‡ªç„¶ãªæ¬¡å›äºˆå‘Šãƒ‘ã‚¿ãƒ¼ãƒ³
        next_previews = [
            "æ¬¡å›ã¯ã€Excelåœ°ç„ã‹ã‚‰è„±å‡ºã™ã‚‹7ã¤ã®å®Ÿè·µçš„æ‰‹é †ã€ã«ã¤ã„ã¦æ›¸ã“ã†ã¨æ€ã„ã¾ã™ã€‚",
            "ä»Šåº¦ã¯ã€ExcelåŠ¹ç‡åŒ–ã®ç¾å®Ÿçš„ãªæ–¹æ³•ã€ã®è©±ã‚’ã—ã¾ã™ã­ã€‚",
            "ã€Excelä½œæ¥­ã‚’åŠ‡çš„ã«çŸ­ç¸®ã™ã‚‹æ–¹æ³•ã€ã«ã¤ã„ã¦ã‚‚é¢ç™½ã„è©±ãŒã‚ã‚‹ã®ã§ã€ã¾ãŸæ›¸ãã¾ã™ã€‚"
        ]

        next_preview = random.choice(next_previews)

        conclusion = f'''## ã¾ã¨ã‚

{core_message["reality_check"]}ã¨ã„ã†ç¾å®Ÿã€åˆ†ã‹ã£ã¦ã„ãŸã ã‘ãŸã§ã—ã‚‡ã†ã‹ã€‚

AIå°å…¥ã¯ç¢ºã‹ã«é­…åŠ›çš„ã§ã™ã€‚ã§ã‚‚ã€åŸºç¤ãŒã§ãã¦ã„ãªã„çŠ¶æ…‹ã§ã®å°å…¥ã¯ã€é«˜ç´šãªèª¿ç†å™¨å…·ã‚’è²·ã£ã¦å†·è”µåº«ã«ä½•ã‚‚å…¥ã£ã¦ãªã„çŠ¶æ³ã¨åŒã˜ã§ã™ã‚ˆã­ã€‚

é †ç•ªã‚’é–“é•ãˆãªã‘ã‚Œã°ï¼š
1. **3ãƒ¶æœˆ**: åŸºç¤ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã§æœˆ25ä¸‡å††ã‚³ã‚¹ãƒˆå‰Šæ¸›
2. **6ãƒ¶æœˆ**: ã‚·ã‚¹ãƒ†ãƒ çµ±åˆã§ã•ã‚‰ãªã‚‹åŠ¹ç‡åŒ–
3. **12ãƒ¶æœˆ**: AIå°å…¥ã§æœ¬æ ¼çš„ãªç«¶äº‰å„ªä½ç¢ºç«‹

ã“ã®é †åºã§é€²ã‚ã‚Œã°ã€AIå°å…¥æ™‚ã«ã¯æ—¢ã«**å¹´300ä¸‡å††ã®ã‚³ã‚¹ãƒˆå‰Šæ¸›**ã¨**æ¥­å‹™åŠ¹ç‡50%å‘ä¸Š**ãŒå®Ÿç¾æ¸ˆã¿ã€‚AIæŠ•è³‡ã®åˆ¤æ–­ã‚‚å†·é™ã«ã§ãã‚‹ã¯ãšã§ã™ã€‚

ä»Šæ—¥ã‹ã‚‰å§‹ã‚ã‚‰ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãšã¯FAXæ©Ÿã®é›»æºã‚’åˆ‡ã‚‹ã“ã¨ã‹ã‚‰ã€‚ãã‚Œã ã‘ã§æœˆ2ä¸‡å††æµ®ãã¾ã™ã‹ã‚‰ã­ã€‚

åœ°å‘³ã ã‘ã©ç¢ºå®Ÿãªæ”¹å–„ã®ç©ã¿é‡ã­ãŒã€çµæœçš„ã«æœ€ã‚‚åŠ¹æœçš„ãªç«¶äº‰åŠ›ã«ãªã‚‹ã€‚ã“ã‚ŒãŒç¾å®Ÿã§ã™ã€‚

{next_preview}'''

        return conclusion

    def _assemble_complete_article(self, opening: str, sections: List[str], conclusion: str) -> Dict[str, Any]:
        """å®Œå…¨è¨˜äº‹ã®çµ±åˆ"""

        full_content = opening + "\n\n" + "\n\n".join(sections) + "\n\n" + conclusion

        article = {
            "content": full_content,
            "word_count": len(full_content),
            "style_compliance": {
                "narita_tone": "âœ… ç—›çƒˆã ãŒå»ºè¨­çš„",
                "humor_elements": "âœ… æ¯’èˆŒãƒ¦ãƒ¼ãƒ¢ã‚¢å«æœ‰",
                "data_backing": "âœ… æ•°å€¤ãƒ»è¡¨ã«ã‚ˆã‚‹è£ä»˜ã‘",
                "practical_value": "âœ… å…·ä½“çš„è¡Œå‹•æŒ‡é‡æç¤º",
                "reader_empathy": "âœ… èª­è€…ã®ç¾å®Ÿä»£å¼"
            },
            "engagement_features": [
                "ç¾å®Ÿçš„ãªæ•°å€¤ãƒ‡ãƒ¼ã‚¿",
                "å…·ä½“çš„ãªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ",
                "æ¯”è¼ƒè¡¨ã«ã‚ˆã‚‹æ˜ç¢ºåŒ–",
                "æ®µéšçš„å®Ÿè¡Œæ‰‹é †",
                "æ¬¡å›äºˆå‘Šã«ã‚ˆã‚‹ç¶™ç¶šèª­è€…åŒ–"
            ],
            "generated_at": datetime.now().isoformat()
        }

        return article

def test_narita_writing_agent():
    """ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°è¶³è»½ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ"""

    writer = NaritaWritingAshigaru()

    test_brief = {
        "topic": "ChatGPTå°å…¥ã§å¤±æ•—ã™ã‚‹ä¸­å°ä¼æ¥­ã®ç‰¹å¾´",
        "target_audience": "å€‹äººäº‹æ¥­ä¸»ãƒ»ä¸­å°ä¼æ¥­çµŒå–¶è€…",
        "key_points": ["åŸºç¤æ¥­å‹™æœªæ•´ç†", "ROIè¨ˆç®—ãªã—", "æ®µéšçš„å°å…¥ã®æ¬ å¦‚"]
    }

    article = writer.generate_narita_style_article(test_brief)

    print(f"\nğŸ¯ è¨˜äº‹ç”Ÿæˆçµæœ:")
    print(f"  æ–‡å­—æ•°: {article['word_count']:,}å­—")
    print(f"  æˆç”°é¢¨è¦ç´ : {len(article['style_compliance'])}é …ç›®é”æˆ")
    print(f"  ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆè¦ç´ : {len(article['engagement_features'])}å€‹")

if __name__ == "__main__":
    test_narita_writing_agent()